/*!kxbrand(http://www.kxbrand.net)-11-04-2014 */
define(function(a,b){if("undefined"==typeof c)var c=function(){function b(a,b){return-1!=a.className.indexOf(b)}function c(a,c){b(a,c)||(a.className+=" "+c)}function d(a,b){a.className=a.className.replace(b,"")}function e(a){for(var b=[],c=0,d=a.length;d>c;c++)b.push(a[c]);return b}function f(a){return a.split(/\r?\n/)}function g(a){var b="highlighter_";return 0==a.indexOf(b)?a:b+a}function h(a){return K.vars.highlighters[g(a)]}function i(a){return document.getElementById(g(a))}function j(a){K.vars.highlighters[g(a.id)]=a}function k(a,b,c){if(null==a)return null;var d,e,f=1!=c?a.childNodes:[a.parentNode],g={"#":"id",".":"className"}[b.substr(0,1)]||"nodeName";if(d="nodeName"!=g?b.substr(1):b.toUpperCase(),-1!=(a[g]||"").indexOf(d))return a;for(var h=0,i=f.length;f&&i>h&&null==e;h++)e=k(f[h],b,c);return e}function l(a,b){return k(a,b,!0)}function m(a,b,c){c=Math.max(c||0,0);for(var d=c,e=a.length;e>d;d++)if(a[d]==b)return d;return-1}function n(a){return(a||"")+Math.round(1e6*Math.random()).toString()}function o(a,b){var c,d={};for(c in a)d[c]=a[c];for(c in b)d[c]=b[c];return d}function p(a){var b={"true":!0,"false":!1}[a];return null==b?a:b}function q(a,b,c,d,e){var f=(screen.width-c)/2,g=(screen.height-d)/2;e+=", left="+f+", top="+g+", width="+c+", height="+d,e=e.replace(/^,/,"");var h=window.open(a,b,e);return h.focus(),h}function r(a,b,c,d){function e(a){a=a||window.event,a.target||(a.target=a.srcElement,a.preventDefault=function(){this.returnValue=!1}),c.call(d||window,a)}a.attachEvent?a.attachEvent("on"+b,e):a.addEventListener(b,e,!1)}function s(a){window.alert(K.config.strings.alert+a)}function t(a,b){var c=K.vars.discoveredBrushes,d=null;if(null==c){c={};for(var e in K.brushes){var f=K.brushes[e],g=f.aliases;if(null!=g){f.brushName=e.toLowerCase();for(var h=0,i=g.length;i>h;h++)c[g[h]]=e}}K.vars.discoveredBrushes=c}return d=K.brushes[c[a]],null==d&&b&&s(K.config.strings.noBrush+a),d}function u(a,b){for(var c=f(a),d=0,e=c.length;e>d;d++)c[d]=b(c[d],d);return c.join("\r\n")}function v(a){return a.replace(/^[ ]*[\n]+|[\n]*[ ]*$/g,"")}function w(a){for(var b,c={},d=XRegExp("^\\[(?<values>(.*?))\\]$"),e=0,f=XRegExp("(?<name>[\\w-]+)\\s*:\\s*(?<value>[\\w%#-]+|\\[.*?\\]|\".*?\"|'.*?')\\s*;?","g");null!=(b=XRegExp.exec(a,f,e));){var g=b.value.replace(/^['"]|['"]$/g,"");if(null!=g&&d.test(g)){var h=XRegExp.exec(g,d);g=h.values.length>0?h.values.split(/\s*,\s*/):[]}c[b.name]=g,e=b.index+b[0].length}return c}function x(a,b){return null==a||0==a.length||"\n"==a?a:(a=a.replace(/</g,"&lt;"),a=a.replace(/ {2,}/g,function(a){for(var b="",c=0,d=a.length;d-1>c;c++)b+=K.config.space;return b+" "}),null!=b&&(a=u(a,function(a){if(0==a.length)return"";var c="";return a=a.replace(/^(&nbsp;| )+/,function(a){return c=a,""}),0==a.length?c:c+'<code class="'+b+'">'+a+"</code>"})),a)}function y(a,b){for(var c=a.toString();c.length<b;)c="0"+c;return c}function z(a,b){for(var c="",d=0;b>d;d++)c+=" ";return a.replace(/\t/g,c)}function A(a,b){function c(a,b,c){return a.substr(0,b)+e.substr(0,c)+a.substr(b+1,a.length)}for(var d=(f(a),"	"),e="",g=0;50>g;g++)e+="                    ";return a=u(a,function(a){if(-1==a.indexOf(d))return a;for(var e=0;-1!=(e=a.indexOf(d));){var f=b-e%b;a=c(a,e,f)}return a})}function B(a){var b=/<br\s*\/?>|&lt;br\s*\/?&gt;/gi;return 1==K.config.bloggerMode&&(a=a.replace(b,"\n")),1==K.config.stripBrs&&(a=a.replace(b,"")),a}function C(a){return a.replace(/^\s+|\s+$/g,"")}function D(a){for(var b=f(B(a)),c=(new Array,/^\s*/),d=1e3,e=0,g=b.length;g>e&&d>0;e++){var h=b[e];if(0!=C(h).length){var i=c.exec(h);if(null==i)return a;d=Math.min(i[0].length,d)}}if(d>0)for(var e=0,g=b.length;g>e;e++)b[e]=b[e].substr(d);return b.join("\n")}function E(a,b){return a.index<b.index?-1:a.index>b.index?1:a.length<b.length?-1:a.length>b.length?1:0}function F(a,b){function c(a){return a[0]}var d=null,e=[],f=b.func?b.func:c;for(pos=0;null!=(d=XRegExp.exec(a,b.regex,pos));){var g=f(d,b);"string"==typeof g&&(g=[new K.Match(g,d.index,b.css)]),e=e.concat(g),pos=d.index+d[0].length}return e}function G(a){var b=/(.*)((&gt;|&lt;).*)/;return a.replace(K.regexLib.url,function(a){var c="",d=null;return(d=b.exec(a))&&(a=d[1],c=d[2]),'<a href="'+a+'">'+a+"</a>"+c})}function H(){for(var a=document.getElementsByTagName("script"),b=[],c=0,d=a.length;d>c;c++)"syntaxhighlighter"==a[c].type&&b.push(a[c]);return b}function I(a){var b="<![CDATA[",c="]]>",d=C(a),e=!1,f=b.length,g=c.length;0==d.indexOf(b)&&(d=d.substring(f),e=!0);var h=d.length;return d.indexOf(c)==h-g&&(d=d.substring(0,h-g),e=!0),e?d:a}function J(a){var b,e=a.target,f=l(e,".syntaxhighlighter"),g=l(e,".container"),i=document.createElement("textarea");if(g&&f&&!k(g,"textarea")){b=h(f.id),c(f,"source");for(var j=g.childNodes,m=[],n=0,o=j.length;o>n;n++)m.push(j[n].innerText||j[n].textContent);m=m.join("\r"),m=m.replace(/\u00a0/g," "),i.appendChild(document.createTextNode(m)),g.appendChild(i),i.focus(),i.select(),r(i,"blur",function(){i.parentNode.removeChild(i),d(f,"source")})}}"undefined"!=typeof a&&"undefined"==typeof XRegExp&&(XRegExp=a("./xregexp").XRegExp);var K={defaults:{"class-name":"","first-line":1,"pad-line-numbers":!1,highlight:null,title:null,"smart-tabs":!0,"tab-size":4,gutter:!0,toolbar:!0,"quick-code":!0,collapse:!1,"auto-links":!0,light:!1,unindent:!0,"html-script":!1},config:{space:"&nbsp;",useScriptTags:!0,bloggerMode:!1,stripBrs:!1,tagName:"pre",strings:{expandSource:"expand source",help:"?",alert:"SyntaxHighlighter\n\n",noBrush:"Can't find brush for: ",brushNotHtmlScript:"Brush wasn't configured for html-script option: ",aboutDialog:"<%- about %>"}},vars:{discoveredBrushes:null,highlighters:{}},brushes:{},regexLib:{multiLineCComments:XRegExp("/\\*.*?\\*/","gs"),singleLineCComments:/\/\/.*$/gm,singleLinePerlComments:/#.*$/gm,doubleQuotedString:/"([^\\"\n]|\\.)*"/g,singleQuotedString:/'([^\\'\n]|\\.)*'/g,multiLineDoubleQuotedString:XRegExp('"([^\\\\"]|\\\\.)*"',"gs"),multiLineSingleQuotedString:XRegExp("'([^\\\\']|\\\\.)*'","gs"),xmlComments:XRegExp("(&lt;|<)!--.*?--(&gt;|>)","gs"),url:/\w+:\/\/[\w-.\/?%&=:@;#]*/g,phpScriptTags:{left:/(&lt;|<)\?(?:=|php)?/g,right:/\?(&gt;|>)/g,eof:!0},aspScriptTags:{left:/(&lt;|<)%=?/g,right:/%(&gt;|>)/g},scriptScriptTags:{left:/(&lt;|<)\s*script.*?(&gt;|>)/gi,right:/(&lt;|<)\/\s*script\s*(&gt;|>)/gi}},toolbar:{getHtml:function(a){function b(a,b){return K.toolbar.getButtonHtml(a,b,K.config.strings[b])}for(var c='<div class="toolbar">',d=K.toolbar.items,e=d.list,f=0,g=e.length;g>f;f++)c+=(d[e[f]].getHtml||b)(a,e[f]);return c+="</div>"},getButtonHtml:function(a,b,c){return'<span><a href="#" class="toolbar_item command_'+b+" "+b+'">'+c+"</a></span>"},handler:function(a){function b(a){var b=new RegExp(a+"_(\\w+)"),c=b.exec(d);return c?c[1]:null}var c=a.target,d=c.className||"",e=h(l(c,".syntaxhighlighter").id),f=b("command");e&&f&&K.toolbar.items[f].execute(e),a.preventDefault()},items:{list:["expandSource","help"],expandSource:{getHtml:function(a){if(1!=a.getParam("collapse"))return"";var b=a.getParam("title");return K.toolbar.getButtonHtml(a,"expandSource",b?b:K.config.strings.expandSource)},execute:function(a){var b=i(a.id);d(b,"collapsed")}},help:{execute:function(){var a=q("","_blank",500,250,"scrollbars=0"),b=a.document;b.write(K.config.strings.aboutDialog),b.close(),a.focus()}}}},findElements:function(a,b){var c=b?[b]:e(document.getElementsByTagName(K.config.tagName)),d=K.config,f=[];if(d.useScriptTags&&(c=c.concat(H())),0===c.length)return f;for(var g=0,h=c.length;h>g;g++){var i={target:c[g],params:o(a,w(c[g].className))};null!=i.params.brush&&f.push(i)}return f},highlight:function(a,b){var c=this.findElements(a,b),d="innerHTML",e=null,f=K.config;if(0!==c.length)for(var g=0,h=c.length;h>g;g++){var i,b=c[g],j=b.target,k=b.params,l=k.brush;if(null!=l){if("true"==k["html-script"]||1==K.defaults["html-script"])e=new K.HtmlScript(l),l="htmlscript";else{var m=t(l);if(!m)continue;e=new m}i=j[d],f.useScriptTags&&(i=I(i)),""!=(j.title||"")&&(k.title=j.title),k.brush=l,e.init(k),b=e.getDiv(i),""!=(j.id||"")&&(b.id=j.id),j.parentNode.replaceChild(b,j)}}},all:function(a){r(window,"load",function(){K.highlight(a)})}};return K.Match=function(a,b,c){this.value=a,this.index=b,this.length=a.length,this.css=c,this.brushName=null},K.Match.prototype.toString=function(){return this.value},K.HtmlScript=function(a){function b(a,b){for(var c=0,d=a.length;d>c;c++)a[c].index+=b}function c(a){for(var c,f=a.code,g=[],h=d.regexList,i=a.index+a.left.length,j=d.htmlScript,k=0,l=h.length;l>k;k++)c=F(f,h[k]),b(c,i),g=g.concat(c);null!=j.left&&null!=a.left&&(c=F(a.left,j.left),b(c,a.index),g=g.concat(c)),null!=j.right&&null!=a.right&&(c=F(a.right,j.right),b(c,a.index+a[0].lastIndexOf(a.right)),g=g.concat(c));for(var m=0,l=g.length;l>m;m++)g[m].brushName=e.brushName;return g}var d,e=t(a),f=new K.brushes.Xml,g=this,h="getDiv getHtml init".split(" ");if(null!=e){d=new e;for(var i=0,j=h.length;j>i;i++)(function(){var a=h[i];g[a]=function(){return f[a].apply(f,arguments)}})();return null==d.htmlScript?void s(K.config.strings.brushNotHtmlScript+a):void f.regexList.push({regex:d.htmlScript.code,func:c})}},K.Highlighter=function(){},K.Highlighter.prototype={getParam:function(a,b){var c=this.params[a];return p(null==c?b:c)},create:function(a){return document.createElement(a)},findMatches:function(a,b){var c=[];if(null!=a)for(var d=0,e=a.length;e>d;d++)"object"==typeof a[d]&&(c=c.concat(F(b,a[d])));return this.removeNestedMatches(c.sort(E))},removeNestedMatches:function(a){for(var b=0,c=a.length;c>b;b++)if(null!==a[b])for(var d=a[b],e=d.index+d.length,f=b+1,c=a.length;c>f&&null!==a[b];f++){var g=a[f];if(null!==g){if(g.index>e)break;g.index==d.index&&g.length>d.length?a[b]=null:g.index>=d.index&&g.index<e&&(a[f]=null)}}return a},figureOutLineNumbers:function(a){var b=[],c=parseInt(this.getParam("first-line"));return u(a,function(a,d){b.push(d+c)}),b},isLineHighlighted:function(a){var b=this.getParam("highlight",[]);return"object"!=typeof b&&null==b.push&&(b=[b]),-1!=m(b,a.toString())},getLineHtml:function(a,b,c){var d=["line","number"+b,"index"+a,"alt"+(b%2==0?1:2).toString()];return this.isLineHighlighted(b)&&d.push("highlighted"),0==b&&d.push("break"),'<div class="'+d.join(" ")+'">'+c+"</div>"},getLineNumbersHtml:function(a,b){var c="",d=f(a).length,e=parseInt(this.getParam("first-line")),g=this.getParam("pad-line-numbers");1==g?g=(e+d-1).toString().length:1==isNaN(g)&&(g=0);for(var h=0;d>h;h++){var i=b?b[h]:e+h,a=0==i?K.config.space:y(i,g);c+=this.getLineHtml(h,i,a)}return c},getCodeLinesHtml:function(a,b){a=C(a);for(var c=f(a),d=(this.getParam("pad-line-numbers"),parseInt(this.getParam("first-line"))),a="",e=this.getParam("brush"),g=0,h=c.length;h>g;g++){var i=c[g],j=/^(&nbsp;|\s)+/.exec(i),k=null,l=b?b[g]:d+g;null!=j&&(k=j[0].toString(),i=i.substr(k.length),k=k.replace(" ",K.config.space)),i=C(i),0==i.length&&(i=K.config.space),a+=this.getLineHtml(g,l,(null!=k?'<code class="'+e+' spaces">'+k+"</code>":"")+i)}return a},getTitleHtml:function(a){return a?"<caption>"+a+"</caption>":""},getMatchesHtml:function(a,b){function c(a){var b=a?a.brushName||f:f;return b?b+" ":""}for(var d=0,e="",f=this.getParam("brush",""),g=0,h=b.length;h>g;g++){var i,j=b[g];null!==j&&0!==j.length&&(i=c(j),e+=x(a.substr(d,j.index-d),i+"plain")+x(j.value,i+j.css),d=j.index+j.length+(j.offset||0))}return e+=x(a.substr(d),c()+"plain")},getHtml:function(a){var b,c,d,e="",f=["syntaxhighlighter"];return 1==this.getParam("light")&&(this.params.toolbar=this.params.gutter=!1),className="syntaxhighlighter",1==this.getParam("collapse")&&f.push("collapsed"),0==(gutter=this.getParam("gutter"))&&f.push("nogutter"),f.push(this.getParam("class-name")),f.push(this.getParam("brush")),a=v(a).replace(/\r/g," "),b=this.getParam("tab-size"),a=1==this.getParam("smart-tabs")?A(a,b):z(a,b),this.getParam("unindent")&&(a=D(a)),gutter&&(d=this.figureOutLineNumbers(a)),c=this.findMatches(this.regexList,a),e=this.getMatchesHtml(a,c),e=this.getCodeLinesHtml(e,d),this.getParam("auto-links")&&(e=G(e)),"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.match(/MSIE/)&&f.push("ie"),e='<div id="'+g(this.id)+'" class="'+f.join(" ")+'">'+(this.getParam("toolbar")?K.toolbar.getHtml(this):"")+'<table border="0" cellpadding="0" cellspacing="0">'+this.getTitleHtml(this.getParam("title"))+"<tbody><tr>"+(gutter?'<td class="gutter">'+this.getLineNumbersHtml(a)+"</td>":"")+'<td class="code"><div class="container">'+e+"</div></td></tr></tbody></table></div>"},getDiv:function(a){null===a&&(a=""),this.code=a;var b=this.create("div");return b.innerHTML=this.getHtml(a),this.getParam("toolbar")&&r(k(b,".toolbar"),"click",K.toolbar.handler),this.getParam("quick-code")&&r(k(b,".code"),"dblclick",J),b},init:function(a){this.id=n(),j(this),this.params=o(K.defaults,a||{}),1==this.getParam("light")&&(this.params.toolbar=this.params.gutter=!1)},getKeywords:function(a){return a=a.replace(/^\s+|\s+$/g,"").replace(/\s+/g,"|"),"\\b(?:"+a+")\\b"},forHtmlScript:function(a){var b={end:a.right.source};a.eof&&(b.end="(?:(?:"+b.end+")|$)"),this.htmlScript={left:{regex:a.left,css:"script"},right:{regex:a.right,css:"script"},code:XRegExp("(?<left>"+a.left.source+")(?<code>.*?)(?<right>"+b.end+")","sgi")}}},K}();b.SyntaxHighlighter=c});